FROM node:20 AS build
WORKDIR /web
COPY web/package.json web/package-lock.json* ./
RUN npm ci
COPY web .
RUN npm run build


FROM caddy:2
WORKDIR /srv/web
COPY --from=build /web/dist .